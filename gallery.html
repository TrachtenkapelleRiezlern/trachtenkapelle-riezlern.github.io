<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Album – Trachtenkapelle Riezlern</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/svg+xml" href="images/logo.png" />
</head>
<body>
<div id="site-header"></div>
<div style="height:var(--nav-height);padding-top:48px;"></div>

<section style="background:var(--white);">
  <a href="bilder.html" class="text-link" style="display:inline-block;margin-bottom:24px;">← Alle Alben</a>
  <div id="galleryHeader">
    <div class="section-label" id="galleryDatum"></div>
    <h2 class="section-title" id="galleryTitel">Album wird geladen…</h2>
    <p id="galleryCount" style="color:var(--text-mid);font-size:0.85rem;margin-bottom:32px;"></p>
  </div>

  <div class="gallery-grid" id="galleryGrid" style="gap:8px;">
    <div style="padding:40px;color:var(--text-mid);">Bilder werden geladen…</div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.92);z-index:1000;align-items:center;justify-content:center;cursor:zoom-out;" onclick="closeLightbox()">
    <button onclick="event.stopPropagation();lbNav(-1)" style="position:absolute;left:20px;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.15);border:none;color:#fff;font-size:2rem;padding:12px 18px;border-radius:8px;cursor:pointer;">&#8249;</button>
    <img id="lightboxImg" src="" style="max-width:92vw;max-height:92vh;object-fit:contain;border-radius:4px;" />
    <button onclick="event.stopPropagation();lbNav(1)" style="position:absolute;right:20px;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.15);border:none;color:#fff;font-size:2rem;padding:12px 18px;border-radius:8px;cursor:pointer;">&#8250;</button>
    <button onclick="closeLightbox()" style="position:absolute;top:16px;right:20px;background:none;border:none;color:#fff;font-size:1.8rem;cursor:pointer;">✕</button>
  </div>
</section>

<div id="site-footer"></div>
<script src="main.js"></script>
<script>
// Known albums with their info – extend this list as you add albums
const ALBUM_META = {
  bmf_donnerstag:         { titel: 'BMF – Donnerstag',         datum: '11. August 2016' },
  bmf_freitag:            { titel: 'BMF – Freitag',            datum: '11. August 2016' },
  bmf_samstag:            { titel: 'BMF – Samstag',            datum: '11. August 2016' },
  bmf_sonntag:            { titel: 'BMF – Sonntag',            datum: '11. August 2016' },
  fotoshooting_kanzelwand:{ titel: 'Fotoshooting Kanzelwand',  datum: '17. September 2023' },
  sommerkonzerte_2020:    { titel: 'Sommerkonzerte 2020',      datum: '15. September 2020' },
  tdb_2020:               { titel: 'Tag der Blasmusik 2020',   datum: '15. September 2020' },
};

const params = new URLSearchParams(location.search);
const albumId = params.get('album') || '';
const meta = ALBUM_META[albumId] || { titel: albumId, datum: '' };
document.getElementById('galleryTitel').textContent = meta.titel;
document.getElementById('galleryDatum').textContent = meta.datum;

// Try loading index.json first, fall back to scanning common image names
let lbImages = [];
let lbIndex  = 0;

function openLightbox(idx) {
  lbIndex = idx;
  const lb = document.getElementById('lightbox');
  document.getElementById('lightboxImg').src = lbImages[idx];
  lb.style.display = 'flex';
}
function closeLightbox() {
  document.getElementById('lightbox').style.display = 'none';
}
function lbNav(dir) {
  lbIndex = (lbIndex + dir + lbImages.length) % lbImages.length;
  document.getElementById('lightboxImg').src = lbImages[lbIndex];
}
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowRight') lbNav(1);
  if (e.key === 'ArrowLeft')  lbNav(-1);
  if (e.key === 'Escape') closeLightbox();
});

function renderImages(imgs) {
  lbImages = imgs;
  const grid = document.getElementById('galleryGrid');
  document.getElementById('galleryCount').textContent = imgs.length + ' Bilder';
  if (!imgs.length) {
    grid.innerHTML = '<p style="color:var(--text-mid);">Noch keine Bilder in diesem Album.</p>';
    return;
  }
  grid.innerHTML = imgs.map((src, i) => `
    <div class="g-item" onclick="openLightbox(${i})">
      <img src="${src}" alt="Bild ${i+1}" loading="lazy" />
      <div class="g-overlay"></div>
    </div>`).join('');
}

// Load from index.json
fetch(`images/gallery/alben/${albumId}/index.json`)
  .then(r => r.json())
  .then(data => {
    if (data.bilder && data.bilder.length) {
      renderImages(data.bilder.map(f => `images/gallery/alben/${albumId}/${f}`));
    } else {
      renderImages([]);
    }
  })
  .catch(() => renderImages([]));
</script>
</body>
</html>